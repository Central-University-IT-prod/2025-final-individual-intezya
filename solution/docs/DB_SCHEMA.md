# Документация схемы базы данных рекламной системы

## Общее описание

База данных представляет собой схему рекламной системы с возможностью таргетирования и отслеживания действий
пользователей. Система включает управление рекламодателями, рекламными объявлениями, клиентами и их действиями, а также
механизм машинного обучения для оценки взаимодействий.

## Таблицы

### advertisements (Рекламные объявления)

Основная таблица для хранения рекламных объявлений.

| Поле                | Тип           | Описание                            |
|---------------------|---------------|-------------------------------------|
| id                  | uuid          | Уникальный идентификатор объявления |
| advertiser_id       | uuid          | Внешний ключ на рекламодателя       |
| title               | varchar(255)  | Заголовок объявления                |
| text                | text          | Текст объявления                    |
| impressions_limit   | integer       | Максимальное количество показов     |
| clicks_limit        | integer       | Максимальное количество кликов      |
| current_impressions | integer       | Текущее количество показов          |
| current_clicks      | integer       | Текущее количество кликов           |
| cost_per_impression | numeric(10,2) | Стоимость за показ                  |
| cost_per_click      | numeric(10,2) | Стоимость за клик                   |
| targeting_gender    | varchar(6)    | Таргетинг по полу                   |
| targeting_age_from  | integer       | Минимальный возраст таргетинга      |
| targeting_age_to    | integer       | Максимальный возраст таргетинга     |
| targeting_location  | varchar(255)  | Таргетинг по местоположению         |
| start_date          | integer       | Дата начала кампании                |
| end_date            | integer       | Дата окончания кампании             |
| image_url           | text          | URL изображения объявления          |
| moderated_and_valid | boolean       | Флаг модерации и валидности         |

### advertisers (Рекламодатели)

Таблица для хранения информации о рекламодателях.

| Поле | Тип          | Описание                               |
|------|--------------|----------------------------------------|
| id   | uuid         | Уникальный идентификатор рекламодателя |
| name | varchar(255) | Название компании/имя рекламодателя    |

### clients (Клиенты)

Таблица для хранения информации о пользователях системы.

| Поле     | Тип          | Описание                         |
|----------|--------------|----------------------------------|
| id       | uuid         | Уникальный идентификатор клиента |
| login    | varchar(255) | Логин пользователя               |
| age      | integer      | Возраст пользователя             |
| location | varchar(255) | Местоположение пользователя      |
| gender   | varchar(6)   | Пол пользователя                 |

### client_actions (Действия клиентов)

Таблица для отслеживания взаимодействий пользователей с рекламой.

| Поле             | Тип           | Описание                                |
|------------------|---------------|-----------------------------------------|
| id               | varchar       | Уникальный идентификатор действия       |
| client_id        | uuid          | Внешний ключ на клиента                 |
| advertisement_id | uuid          | Внешний ключ на рекламное объявление    |
| advertiser_id    | uuid          | Внешний ключ на рекламодателя           |
| action_type      | varchar(255)  | Тип действия (например, клик, просмотр) |
| cost             | numeric(10,2) | Стоимость действия                      |
| created_at       | integer       | Временная метка действия                |

### ml_scores (Оценки машинного обучения)

Таблица для хранения результатов оценки взаимодействий клиентов с рекламодателями.

| Поле          | Тип     | Описание                        |
|---------------|---------|---------------------------------|
| id            | varchar | Уникальный идентификатор оценки |
| client_id     | uuid    | Внешний ключ на клиента         |
| advertiser_id | uuid    | Внешний ключ на рекламодателя   |
| score         | integer | Оценка взаимодействия           |

### global_settings (Глобальные настройки)

Таблица для хранения глобальных настроек системы.

| Поле           | Тип          | Описание           |
|----------------|--------------|--------------------|
| settings_key   | varchar(255) | Ключ настройки     |
| settings_value | varchar(255) | Значение настройки |

## Связи между таблицами

1. advertisements -> advertisers
    - advertisements.advertiser_id ссылается на advertisers.id
    - Связь определяет принадлежность рекламного объявления конкретному рекламодателю

2. client_actions -> advertisements
    - client_actions.advertisement_id ссылается на advertisements.id
    - Отслеживает действия пользователей с конкретными объявлениями

3. client_actions -> advertisers
    - client_actions.advertiser_id ссылается на advertisers.id
    - Связывает действия пользователей с рекламодателями

4. client_actions -> clients
    - client_actions.client_id ссылается на clients.id
    - Определяет, какой пользователь совершил действие

5. ml_scores -> advertisers
    - ml_scores.advertiser_id ссылается на advertisers.id
    - Связывает оценки ML с рекламодателями

6. ml_scores -> clients
    - ml_scores.client_id ссылается на clients.id
    - Связывает оценки ML с клиентами

## Особенности

1. Все идентификаторы используют тип UUID для обеспечения уникальности across shards
2. Временные метки хранятся как integer
3. Система поддерживает детальное таргетирование по возрасту, полу и местоположению

![DB SCHEMA](../assets/DB_SCHEMA.png)
